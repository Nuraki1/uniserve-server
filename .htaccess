###############################################################################
# Apache .htaccess for the Express API server (cPanel/Passenger deployment)
#
# Place this file in your API document root (typically the subdomain root),
# or wherever Apache serves the API domain from.
#
# IMPORTANT:
# - You MUST replace the Passenger paths with your real absolute paths.
# - This is NOT the SPA .htaccess (do not rewrite to index.html here).
###############################################################################

<IfModule mod_passenger.c>
  PassengerEnabled on
  PassengerAppType node

  # Absolute path to the backend folder (THIS repo's uniserve-server/server)
  # مثال:
  # PassengerAppRoot /home/yourcpaneluser/repositories/Uniserve/uniserve-server/server
  PassengerAppRoot /ABSOLUTE/PATH/TO/uniserve-server/server

  # Entry file to start your server (matches package.json: "start": "node dist/index.js")
  PassengerStartupFile dist/index.js

  # Node binary (optional but recommended on cPanel).
  # You can find it in cPanel -> Setup Node.js App -> "Application startup file" page,
  # or by running: `which node`
  #
  # Example:
  # PassengerNodejs /home/yourcpaneluser/nodevenv/yourapp/18/bin/node
  #PassengerNodejs /ABSOLUTE/PATH/TO/node

  # Environment
  PassengerEnvVar NODE_ENV production
  PassengerEnvVar TZ UTC

  # (Optional) log file for Passenger app errors
  #PassengerAppLogFile /home/yourcpaneluser/logs/uniserve-api-passenger.log
</IfModule>

# Basic hardening
Options -Indexes

<IfModule mod_headers.c>
  # Avoid leaking server details
  Header always unset X-Powered-By
</IfModule>

###############################################################################
# Notes
#
# 1) Your Express server already handles CORS. Do NOT add CORS headers here
#    unless you have a very specific reason.
#
# 2) Socket.IO:
#    Passenger supports WebSocket/upgrade when enabled on the server.
#    Make sure your hosting supports WebSockets for Node apps.
#
# 3) If you deploy the API under a sub-path (e.g. https://domain.com/api),
#    you'll need PassengerBaseURI and correct document root mapping — usually
#    easier to deploy as its own subdomain (api.domain.com).
###############################################################################


